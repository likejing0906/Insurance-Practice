<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ä¿éšªè€ƒè©¦å…¨èƒ½é¡Œåº«</title>
    <style>
        body {
            font-family: "Microsoft JhengHei", Arial, sans-serif;
            max-width: 800px;
            margin: 0 auto;
            padding: 20px;
            background-color: #f0f2f5;
        }
        .header-section {
            text-align: center;
            background: #2c3e50;
            color: white;
            padding: 20px;
            border-radius: 10px;
            margin-bottom: 20px;
        }
        .selector-box {
            background: white;
            padding: 15px;
            border-radius: 8px;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
            margin-bottom: 20px;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
        }
        select {
            padding: 8px 15px;
            font-size: 16px;
            border-radius: 5px;
            border: 1px solid #ddd;
        }
        .question-block {
            background: white;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
            margin-bottom: 20px;
        }
        .question-title { font-size: 18px; font-weight: bold; margin-bottom: 12px; color: #1a73e8; }
        .options label {
            display: block;
            margin: 10px 0;
            padding: 12px;
            background: #f8f9fa;
            border-radius: 6px;
            cursor: pointer;
            border: 1px solid #eee;
            transition: 0.2s;
        }
        .options label:hover { background: #e8f0fe; }
        .result-msg {
            margin-top: 10px; padding: 12px; font-weight: bold; border-radius: 6px; display: none;
        }
        .result-correct { background: #d4edda; color: #155724; border-left: 5px solid #28a745; }
        .result-wrong { background: #f8d7da; color: #721c24; border-left: 5px solid #dc3545; }
        #submit-btn {
            width: 100%; padding: 18px; font-size: 20px;
            background: #28a745; color: white; border: none;
            border-radius: 8px; cursor: pointer; margin-top: 20px;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
        }
        #submit-btn:hover { background: #218838; }
        .loading { text-align: center; color: #666; font-style: italic; }
    </style>
</head>
<body>

    <div class="header-section">
        <h1>ğŸ“– ä¿éšªè€ƒè©¦å…¨èƒ½é¡Œåº«</h1>
    </div>

    <div class="selector-box">
        <strong>é¸æ“‡ç§‘ç›®ï¼š</strong>
        <select id="quiz-selector" onchange="loadSelectedQuiz()">
            <option value="">-- è«‹é¸æ“‡é¡Œåº« --</option>
            <option value="subject1">ä¿éšªå¯¦å‹™</option>
            <option value="subject2">ä¿éšªæ³•è¦</option>
            </select>
        <button onclick="loadSelectedQuiz()" style="padding: 7px 12px; cursor:pointer;">åˆ·æ–°é¡Œç›®</button>
    </div>

    <div id="quiz-area">
        <p class="loading">è«‹å¾ä¸Šæ–¹é¸å–®é¸æ“‡ä¸€å€‹ç§‘ç›®é–‹å§‹ç·´ç¿’ã€‚</p>
    </div>
    
    <button id="submit-btn" onclick="checkAnswers()" style="display:none;">äº¤å·å°ç­”æ¡ˆ</button>

    <script>
        // --- é€™è£¡è¨­å®šä½ çš„ CSV ç¶²å€ ---
        const quizSources = {
            "subject1": "é€™è£¡è²¼ä¸Šä½ çš„ã€ä¿éšªå¯¦å‹™ã€‘CSVç¶²å€",
            "subject2": "é€™è£¡è²¼ä¸Šä½ çš„ã€ä¿éšªæ³•è¦ã€‘CSVç¶²å€"
        };

        let currentQuestions = [];

        function loadSelectedQuiz() {
            const select = document.getElementById('quiz-selector');
            const subjectKey = select.value;
            const quizArea = document.getElementById('quiz-area');
            const submitBtn = document.getElementById('submit-btn');

            if (!subjectKey) {
                quizArea.innerHTML = '<p class="loading">è«‹é¸æ“‡ä¸€å€‹ç§‘ç›®ã€‚</p>';
                submitBtn.style.display = 'none';
                return;
            }

            const url = quizSources[subjectKey];
            quizArea.innerHTML = '<p class="loading">é¡Œåº«è®€å–ä¸­ï¼Œè«‹ç¨å€™...</p>';
            submitBtn.style.display = 'none';

            fetch(url)
                .then(res => res.text())
                .then(text => {
                    parseAndRender(text);
                    submitBtn.style.display = 'block';
                })
                .catch(err => {
                    quizArea.innerHTML = '<p style="color:red;">è®€å–å¤±æ•—ï¼Œè«‹ç¢ºèªè©²è©¦ç®—è¡¨æ˜¯å¦å·²ã€Œç™¼å¸ƒåˆ°ç¶²è·¯ã€ä¸¦é¸æ“‡ CSV æ ¼å¼ã€‚</p>';
                });
        }

        function parseAndRender(csvText) {
            const rows = csvText.split('\n').map(r => r.trim()).filter(r => r);
            currentQuestions = [];
            
            // å¾ç¬¬1åˆ—é–‹å§‹è®€(è·³éæ¨™é¡Œåˆ—)
            for (let i = 1; i < rows.length; i++) {
                const cols = parseCSVRow(rows[i]);
                if (cols.length >= 6) {
                    currentQuestions.push({
                        title: cols[0],
                        options: [cols[1], cols[2], cols[3], cols[4]],
                        answer: parseInt(cols[5])
                    });
                }
            }

            const area = document.getElementById('quiz-area');
            area.innerHTML = '';
            currentQuestions.forEach((q, idx) => {
                let optsHtml = '';
                q.options.forEach((opt, i) => {
                    optsHtml += `<label><input type="radio" name="q${idx}" value="${i+1}"> (${i+1}) ${opt}</label>`;
                });
                area.innerHTML += `
                    <div class="question-block">
                        <div class="question-title">${idx+1}. ${q.title}</div>
                        <div class="options">${optsHtml}</div>
                        <div class="result-msg" id="res${idx}"></div>
                    </div>
                `;
            });
        }

        function parseCSVRow(row) {
            const result = [];
            let current = '';
            let inQuote = false;
            for (let i = 0; i < row.length; i++) {
                const char = row[i];
                if (char === '"') inQuote = !inQuote;
                else if (char === ',' && !inQuote) {
                    result.push(current.trim());
                    current = '';
                } else current += char;
            }
            result.push(current.trim());
            return result;
        }

        function checkAnswers() {
            let score = 0;
            currentQuestions.forEach((q, idx) => {
                const selected = document.querySelector(`input[name="q${idx}"]:checked`);
                const resDiv = document.getElementById(`res${idx}`);
                resDiv.style.display = 'block';
                
                if (!selected) {
                    resDiv.className = 'result-msg result-wrong';
                    resDiv.innerHTML = `âŒ æœªä½œç­” (æ­£ç¢ºç­”æ¡ˆæ˜¯ï¼š${q.answer})`;
                } else if (parseInt(selected.value) === q.answer) {
                    resDiv.className = 'result-msg result-correct';
                    resDiv.innerHTML = 'âœ… ç­”å°äº†ï¼';
                    score++;
                } else {
                    resDiv.className = 'result-msg result-wrong';
                    resDiv.innerHTML = `âŒ ç­”éŒ¯äº† (æ­£ç¢ºç­”æ¡ˆæ˜¯ï¼š${q.answer} - ${q.options[q.answer-1]})`;
                }
            });
            window.scrollTo(0, 0);
            alert(`æ¸¬é©—çµæŸï¼æ‚¨çš„å¾—åˆ†æ˜¯ï¼š${Math.round(score/currentQuestions.length*100)} åˆ†`);
        }
    </script>
</body>
</html>
